# ChestX-ray14 Multi-label Classification using CLIP and C-Adapter

## Overview

This repository contains code for multi-label classification of chest X-ray images using a CLIP-based model enhanced with a lightweight C-Adapter. It includes data preprocessing, model training, and evaluation, conducted on a High-Performance Computing (HPC) environment.

## File Structure

- `00_data/`: Raw dataset used for the project.(chest X-ray images not included, which can be found in Kaggle)
- `01_preprocess_data/`: Processed data generated by the `01_datapreprocess` script. These files are used as multi-label classification labels.
- `02_chestxray_CLIP.ipynb`: Main notebook for training the CLIP model with a C-Adapter using image and text embeddings (excluding fusion during evaluation).
- `03_chestxray_CLIP_shared_embedding.ipynb`: Experimental notebook combining both image and text embeddings into the adapter. This model was **not used** in final evaluation, as reports are not assumed to be available during inference.

## Running the Code

To reproduce our results, follow this order:
1. Preprocess the data by running `01_datapreprocess` to generate `01_preprocess_data/`.
2. Run the main training pipeline in `02_chestxray_CLIP.ipynb`.

## Dependencies

The code is designed to run in a High-Performance Computing (HPC) environment. Use the following setup to create and activate the environment:

```bash
module load miniconda
conda create -y -n clip_env python jupyter numpy pandas matplotlib
conda activate clip_env
pip install torch
pip install torchvision
pip install transformers
ycrc_conda_env.sh update
```

## Pretrained Models and Datasets Used
### Pretrained Models
ResNet: Image encoder initialized from pretrained ResNet weights, then fine-tuned on the Chest X-ray data.
Bio_ClinicalBERT: Domain-specific BERT variant trained on clinical notes; used as the text encoder and fine-tuned during training.

### Dataset
Indiana University Chest X-ray: Used as the primary dataset, including radiology reports and associated chest X-ray images. Accessible at [Indiana University Chest X-ray Collection (Kaggle)](https://www.kaggle.com/datasets/raddar/chest-xrays-indiana-university/data).

